/* simplyScroll 2 - a scroll-tastic jQuery plugin - http://logicbox.net/jquery/simplyscroll/ - (c) 2009-2012 Will Kelly - http://logicbox.net - Dual licensed under the MIT and GPL licenses - Version: 2.0.5 Last revised: 10/05/2012 */
/* tellibus fork by A. Bennouna - http://tellibus.com - Adds support for user-specified control HTML elements */
(function(e,t,n){e.fn.simplyScroll=function(t){return this.each(function(){new e.simplyScroll(this,t)})};var r={customClass:"simply-scroll",frameRate:24,speed:1,orientation:"horizontal",auto:true,autoMode:"loop",manualMode:"end",direction:"forwards",pauseOnHover:true,pauseOnTouch:true,pauseButton:false,startOnLoad:false,forwardButtonElement:false,backButtonElement:false,pauseButtonElement:false};e.simplyScroll=function(n,i){var s=this;this.o=e.extend({},r,i||{});this.isAuto=this.o.auto!==false&&this.o.autoMode.match(/^loop|bounce$/)!==null;this.isHorizontal=this.o.orientation.match(/^horizontal|vertical$/)!==null&&this.o.orientation==r.orientation;this.isRTL=this.isHorizontal&&e("html").attr("dir")=="rtl";this.isForwards=!this.isAuto||this.isAuto&&this.o.direction.match(/^forwards|backwards$/)!==null&&this.o.direction==r.direction&&!this.isRTL;this.isLoop=this.isAuto&&this.o.autoMode=="loop"||!this.isAuto&&this.o.manualMode=="loop";this.userControls=this.o.forwardButtonElement!=""&&this.o.backButtonElement!="";this.userPauseControl=this.o.pauseButtonElement!="";this.supportsTouch="createTouch"in document;this.events=this.supportsTouch?{start:"touchstart MozTouchDown",move:"touchmove MozTouchMove",end:"touchend touchcancel MozTouchRelease"}:{start:"mouseenter",end:"mouseleave"};this.$list=e(n);var o=this.$list.children();this.$list.addClass("simply-scroll-list").wrap('<div class="simply-scroll-clip"></div>').parent().wrap('<div class="'+this.o.customClass+' simply-scroll-container"></div>');if(this.userPauseControl){this.o.pauseOnHover=false;this.o.pauseButton=false}if(!this.userControls){if(!this.isAuto){this.$list.parent().parent().prepend('<div class="simply-scroll-forward"></div>').prepend('<div class="simply-scroll-back"></div>')}else{if(this.o.pauseButton){this.$list.parent().parent().prepend('<div class="simply-scroll-btn simply-scroll-btn-pause"></div>');this.o.pauseOnHover=false}}}if(o.length>1){var u=false,a=0;if(this.isHorizontal){o.each(function(){a+=e(this).outerWidth(true)});u=o.eq(0).outerWidth(true)*o.length!==a}else{o.each(function(){a+=e(this).outerHeight(true)});u=o.eq(0).outerHeight(true)*o.length!==a}if(u){this.$list=this.$list.wrap("<div></div>").parent().addClass("simply-scroll-list");if(this.isHorizontal){this.$list.children().css({"float":"left",width:a+"px"})}else{this.$list.children().css({height:a+"px"})}}}if(!this.o.startOnLoad){this.init()}else{e(t).load(function(){s.init()})}};e.simplyScroll.fn=e.simplyScroll.prototype={};e.simplyScroll.fn.extend=e.simplyScroll.extend=e.extend;e.simplyScroll.fn.extend({init:function(){this.$items=this.$list.children();this.$clip=this.$list.parent();this.$container=this.$clip.parent();this.$btnBack=this.userControls?e(this.o.backButtonElement):e(".simply-scroll-back",this.$container);this.$btnForward=this.userControls?e(this.o.forwardButtonElement):e(".simply-scroll-forward",this.$container);if(!this.isHorizontal){this.itemMax=this.$items.eq(0).outerHeight(true);this.clipMax=this.$clip.height();this.dimension="height";this.moveBackClass="simply-scroll-btn-up";this.moveForwardClass="simply-scroll-btn-down";this.scrollPos="Top"}else{this.itemMax=this.$items.eq(0).outerWidth(true);this.clipMax=this.$clip.width();this.dimension="width";this.moveBackClass="simply-scroll-btn-left";this.moveForwardClass="simply-scroll-btn-right";this.scrollPos="Left"}this.posMin=0;this.posMax=this.$items.length*this.itemMax;var t=Math.ceil(this.clipMax/this.itemMax);if(this.isAuto&&this.o.autoMode=="loop"){this.$list.css(this.dimension,this.posMax+this.itemMax*t+"px");this.posMax+=this.clipMax-this.o.speed;if(this.isForwards){this.$items.slice(0,t).clone(true).appendTo(this.$list);this.resetPosition=0;this.resetPositionForwards=t*this.itemMax;this.resetPositionBackwards=this.$items.length*this.itemMax}else{this.$items.slice(-t).clone(true).prependTo(this.$list);this.resetPosition=this.$items.length*this.itemMax;this.resetPositionBackwards=0;this.resetPositionForwards=this.$items.length*this.itemMax;if(this.isRTL){this.$clip[0].dir="ltr";this.$items.css("float","right")}}}else if(!this.isAuto&&this.o.manualMode=="loop"){this.posMax+=this.itemMax*t;this.$list.css(this.dimension,this.posMax+this.itemMax*t+"px");this.posMax+=this.clipMax-this.o.speed;var r=this.$items.slice(0,t).clone(true).appendTo(this.$list);var i=this.$items.slice(-t).clone(true).prependTo(this.$list);this.resetPositionForwards=this.resetPosition=t*this.itemMax;this.resetPositionBackwards=this.$items.length*this.itemMax;var s=this;this.$btnBack.bind(this.events.start,function(){s.isForwards=false;s.resetPosition=s.resetPositionBackwards});this.$btnForward.bind(this.events.start,function(){s.isForwards=true;s.resetPosition=s.resetPositionForwards})}else{this.$list.css(this.dimension,this.posMax+"px");if(this.isForwards){this.resetPosition=0}else{this.resetPosition=this.$items.length*this.itemMax;if(this.isRTL){this.$clip[0].dir="ltr";this.$items.css("float","right")}}}this.resetPos();this.interval=null;this.intervalDelay=Math.floor(1e3/this.o.frameRate);if(!(!this.isAuto&&this.o.manualMode=="end")){while(this.itemMax%this.o.speed!==0){this.o.speed--;if(this.o.speed===0){this.o.speed=1;break}}}var s=this;this.trigger=null;this.funcMoveBack=function(e){if(e!==n){e.preventDefault()}s.trigger=!s.isAuto&&s.o.manualMode=="end"?this:null;if(s.isAuto){s.isForwards?s.moveBack():s.moveForward()}else{s.moveBack()}};this.funcMoveForward=function(e){if(e!==n){e.preventDefault()}s.trigger=!s.isAuto&&s.o.manualMode=="end"?this:null;if(s.isAuto){s.isForwards?s.moveForward():s.moveBack()}else{s.moveForward()}};this.funcMovePause=function(){s.movePause()};this.funcMoveStop=function(){s.moveStop()};this.funcMoveResume=function(){s.moveResume()};if(this.isAuto){this.paused=false;function o(){if(s.paused===false){s.paused=true;s.funcMovePause()}else{s.paused=false;s.funcMoveResume()}return s.paused}if(this.supportsTouch&&this.$items.find("a").length){this.supportsTouch=false}if(this.userControls){this.$btnBack.bind("click",function(t){t.preventDefault();if(!s.$btnBack.hasClass("moving")||s.paused){s.paused=false;s.moveStop(s.movement);if(s.userPauseControl){e(s.o.pauseButtonElement).removeClass("active")}s.resetPosition=s.resetPositionBackwards;s.funcMoveBack(t);s.$btnBack.addClass("moving");s.$btnForward.removeClass("moving")}});this.$btnForward.bind("click",function(t){t.preventDefault();if(!s.$btnForward.hasClass("moving")||s.paused){s.paused=false;s.moveStop(s.movement);if(s.userPauseControl){e(s.o.pauseButtonElement).removeClass("active")}s.resetPosition=s.resetPositionForwards;s.funcMoveForward(t);s.$btnForward.addClass("moving");s.$btnBack.removeClass("moving")}})}if(this.isAuto&&this.o.pauseOnHover&&!this.supportsTouch){this.$clip.bind(this.events.start,this.funcMovePause).bind(this.events.end,this.funcMoveResume)}else if(this.isAuto&&this.o.pauseOnTouch&&!this.o.pauseButton&&this.supportsTouch){var u,a;this.$clip.bind(this.events.start,function(e){o();var t=e.originalEvent.touches[0];u=s.isHorizontal?t.pageX:t.pageY;a=s.$clip[0]["scroll"+s.scrollPos];e.stopPropagation();e.preventDefault()}).bind(this.events.move,function(e){e.stopPropagation();e.preventDefault();var t=e.originalEvent.touches[0],n=s.isHorizontal?t.pageX:t.pageY,r=u-n+a;if(r<0)r=0;else if(r>s.posMax)r=s.posMax;s.$clip[0]["scroll"+s.scrollPos]=r;s.funcMovePause();s.paused=true})}else{if(this.o.pauseButton||this.userPauseControl){$buttonElement=this.userPauseControl?e(this.o.pauseButtonElement):e(".simply-scroll-btn-pause",this.$container);this.$btnPause=$buttonElement.bind("click",function(t){t.preventDefault();o()?e(this).addClass("active"):e(this).removeClass("active")})}}this.funcMoveForward()}else{this.$btnBack.addClass("simply-scroll-btn"+" "+this.moveBackClass).bind(this.events.start,this.funcMoveBack).bind(this.events.end,this.funcMoveStop);this.$btnForward.addClass("simply-scroll-btn"+" "+this.moveForwardClass).bind(this.events.start,this.funcMoveForward).bind(this.events.end,this.funcMoveStop);if(this.o.manualMode=="end"){!this.isRTL?this.$btnBack.addClass("disabled"):this.$btnForward.addClass("disabled")}}},moveForward:function(){var e=this;this.movement="forward";if(this.trigger!==null){this.$btnBack.removeClass("disabled")}e.interval=setInterval(function(){if(e.$clip[0]["scroll"+e.scrollPos]<e.posMax-e.clipMax){e.$clip[0]["scroll"+e.scrollPos]+=e.o.speed}else if(e.isLoop){e.resetPos()}else{e.moveStop(e.movement)}},e.intervalDelay)},moveBack:function(){var e=this;this.movement="back";if(this.trigger!==null){this.$btnForward.removeClass("disabled")}e.interval=setInterval(function(){if(e.$clip[0]["scroll"+e.scrollPos]>e.posMin){e.$clip[0]["scroll"+e.scrollPos]-=e.o.speed}else if(e.isLoop){e.resetPos()}else{e.moveStop(e.movement)}},e.intervalDelay)},movePause:function(){clearInterval(this.interval)},moveStop:function(t){this.movePause();if(this.trigger!==null){if(typeof t!=="undefined"){e(this.trigger).addClass("disabled")}this.trigger=null}if(this.isAuto){if(this.o.autoMode=="bounce"){t=="forward"?this.moveBack():this.moveForward()}}},moveResume:function(){this.movement=="forward"?this.moveForward():this.moveBack()},resetPos:function(){this.$clip[0]["scroll"+this.scrollPos]=this.resetPosition}})})(jQuery,window)